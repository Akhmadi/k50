webpackJsonp([1],{"/Vhq":function(t,e){t.exports={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-layout",{attrs:{row:"",color:"primary"}},[e("v-flex",{staticClass:"layout",attrs:{xs12:""}},[e("v-spacer"),this._v(" "),e("v-btn",{attrs:{href:this.printUrl,color:"accent",target:"_blank"}},[this._v("Печать анкеты")])],1)],1)},staticRenderFns:[]}},2:function(t,e,n){t.exports=n("NeCt")},IFHP:function(t,e,n){var r=n("VU/8")(n("VCYO"),n("bkY1"),!1,null,null,null);t.exports=r.exports},NeCt:function(t,e,n){Vue.component("students",n("IFHP")),Vue.component("student-editpanel",n("S/+k")),AdminManager.registerMiddleware(function(t,e,n){"editpanel:on:mount"==t&&"students"==e.crud.code&&e.addComponents([{id:"student-editpanel-1",name:"student-editpanel",options:{}}]),n()});var r={id:"students-1",name:"students",options:{isModal:!1}};Bus.$on("user:students:mount",function(){return AdminManager.mountComponent(r,!0)})},"S/+k":function(t,e,n){var r=n("VU/8")(n("vuJP"),n("/Vhq"),!1,null,null,null);t.exports=r.exports},VCYO:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"students",props:["options"],data:function(){return{program:null,loading:!1}},computed:{},methods:{removeStudent:function(t){this.program.students=_.filter(this.program.students,function(e){return e.id!==t.id})},approveStudent:function(t){var e=this;this.loading=!0,axios.post(App.baseUrl+"/api/students/approve",{student:t}).then(function(){AdminManager.showSuccess("Студент "+t.name+" подвержден"),e.removeStudent(t),e.loading=!1}).catch(function(t){AdminManager.showError("Ошибка действия"),console.log(t),e.loading=!1})},rejectStudent:function(t){var e=this;this.loading=!0,axios.post(App.baseUrl+"/api/students/reject",{student:t}).then(function(){AdminManager.showSuccess("Студент "+t.name+" удален"),e.removeStudent(t),e.loading=!1}).catch(function(t){AdminManager.showError("Ошибка действия"),console.log(t),e.loading=!1})},getProgram:function(){var t=this;this.loading=!0,axios.get(App.baseUrl+"/api/students").then(function(e){e.data.program.students=_.map(e.data.program.students,function(t){return t.meta=JSON.parse(t.meta),t.printUrl=App.baseUrl+"/student/print/"+t.id,t.meta.files=t.meta.files?_.map(JSON.parse(t.meta.files),function(t){return App.baseUrl+t}):[],t}),t.program=e.data.program,t.loading=!1}).catch(function(e){AdminManager.showError("Ошибка загрузки списка"),console.log(e),t.loading=!1})}},beforeMount:function(){this.getProgram()}}},"VU/8":function(t,e){t.exports=function(t,e,n,r,o,a){var s,i=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(s=t,i=t.default);var c,d="function"==typeof i?i.options:i;if(e&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0),n&&(d.functional=!0),o&&(d._scopeId=o),a?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},d._ssrRegister=c):r&&(c=r),c){var u=d.functional,p=u?d.render:d.beforeCreate;u?(d._injectStyles=c,d.render=function(t,e){return c.call(e),p(t,e)}):d.beforeCreate=p?[].concat(p,c):[c]}return{esModule:s,exports:i,options:d}}},bkY1:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{column:"","fill-height":"","justify-start":""}},[n("v-flex",{staticClass:"layout align-center"},[n("p",{staticClass:"title"},[t._v("Программа "+t._s(t.program?t.program.title:""))]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{disabled:t.loading,color:"accent",flat:"",loading:t.loading},on:{click:t.getProgram}},[t._v("\n            Обновить список\n        ")])],1),t._v(" "),n("v-flex",{staticStyle:{position:"relative"},attrs:{xs12:"","fill-height":""}},[n("div",{staticClass:"scroll-container layout row wrap align-start"},[n("v-flex",{directives:[{name:"show",rawName:"v-show",value:t.program&&0===t.program.students.length&&!t.loading,expression:"program && program.students.length === 0 && !loading"}],attrs:{xs12:""}},[n("v-subheading",[t._v("Список пуст")])],1),t._v(" "),t.program?n("v-flex",{staticClass:"layout row wrap",attrs:{xs12:""}},t._l(t.program.students,function(e){return n("v-flex",{key:e.id,staticClass:"px-1 py-1",attrs:{xs12:"",md3:""}},[n("v-card",[n("v-card-title",[t._v("\n                            "+t._s(e.name)+"\n                        ")]),t._v(" "),n("v-card-actions",[n("v-menu",{attrs:{"offset-y":""}},[n("v-btn",{attrs:{slot:"activator",disabled:t.loading,icon:""},slot:"activator"},[n("v-icon",{attrs:{color:"accent"}},[t._v("more_vert")])],1),t._v(" "),n("v-list",[n("v-list-tile",[n("v-list-tile-title",[n("a",{attrs:{href:e.printUrl,target:"_blank"}},[t._v("Печать анкеты")])])],1),t._v(" "),t._l(e.meta.files,function(r,o){return n("v-list-tile",{key:r},[n("v-list-tile-title",[n("a",{attrs:{href:r,target:"_blank",download:e.name+"_file_"+(o+1)}},[t._v("Файл "+t._s(o+1))])])],1)})],2)],1),t._v(" "),n("v-spacer"),t._v(" "),n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",disabled:t.loading,icon:""},on:{click:function(n){t.approveStudent(e)}},slot:"activator"},[n("v-icon",{attrs:{color:"success"}},[t._v("done")])],1),t._v(" "),n("span",[t._v("Подтвердить")])],1),t._v(" "),n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",disabled:t.loading,icon:""},on:{click:function(n){t.rejectStudent(e)}},slot:"activator"},[n("v-icon",{attrs:{color:"error"}},[t._v("clear")])],1),t._v(" "),n("span",[t._v("Отказать")])],1)],1)],1)],1)})):t._e()],1)])],1)},staticRenderFns:[]}},vuJP:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"student-editpanel",props:["options","crud","item"],data:function(){return{}},computed:{printUrl:function(){return App.baseUrl+"/student/print/"+(this.item?this.item.id:"")}}}}},[2]);